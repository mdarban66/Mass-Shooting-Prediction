library(NLP)
library(tm)
reviews <- read.csv("/media/mona/My Passport/Tweepy-TwitterData/SynchedTime/SentimentAnalysisforRstudio/AA/Feb28.csv", stringsAsFactors = FALSE)
# str(reviews)
review_text <- paste(reviews$Text, collapse=" ")
review_source <- VectorSource(review_text)
corpus <- Corpus(review_source)
corpus <- tm_map(corpus, content_transformer(tolower))
corpus <- tm_map(corpus, removePunctuation)
corpus <- tm_map(corpus, stripWhitespace)
corpus <- tm_map(corpus, removeWords, stopwords("english"))
#stopwords("english")
dtm <- DocumentTermMatrix(corpus)
dtm2 <- as.matrix(dtm)
frequency <- colSums(dtm2)
frequency <- sort(frequency, decreasing=TRUE)
#head(table(frequency),10)
head(frequency)
write.csv(head(frequency),file = "/home/mona/Desktop/Untitled Folderget/R/MyData2.csv")

# library(RColorBrewer)
# library(wordcloud)
# set.seed(142)
# wordcloud(names(frequency),frequency, min.freq = 25)
# wordcloud(names(frequency),freq, min.freq = 20)
# wordcloud(names(frequency),frequency, max.words = 100)

#specific word frequency
library(stringr)

for(day in (10:29)){
  tweets <- read.csv(paste("/media/mona/My Passport/Tweepy-TwitterData/SynchedTime/SentimentAnalysisforRstudio/AA/Feb",day,".csv",sep=""), stringsAsFactors = FALSE)
  #ban, law, prevent, next, may, can, later,again, protect, permit, license, treatment, strict, solution, change
  s1 <- sum(str_count(tolower(tweets$Text),"gun"))
  s2 <- sum(str_count(tolower(tweets$Text),"shooting"))
  s3 <- sum(str_count(tolower(tweets$Text),"mass"))
  s4 <- sum(str_count(tolower(tweets$Text),"next"))
  s5 <- sum(str_count(tolower(tweets$Text),"ban"))
  s6 <- sum(str_count(tolower(tweets$Text),"law"))
  s7 <- sum(str_count(tolower(tweets$Text),"prevent"))
  s8 <- sum(str_count(tolower(tweets$Text),"control"))
  s9 <- sum(str_count(tolower(tweets$Text),"mass shooting"))
  s10 <- sum(str_count(tolower(tweets$Text),"threat"))
  s11 <- sum(str_count(tolower(tweets$Text),"gun control"))
  x <- data.frame(name=c("gun","shooting","mass","next","ban","law","prevent","control","mass shooting","threat","gun control"),a=c(s1,s2,s3,s4,s5,s6,s7,s8,s9,s10,s11))
  write.csv(x,paste("/home/mona/Desktop/Untitled Folderget/R/MyData",day,".csv",sep = ""), row.names = FALSE)
}
#dfread <- read.csv("/home/mona/Desktop/Untitled Folderget/R/MyData3.csv")
#all <- rbind(dfread,x)
#nonDuplicate <- all[!duplicated(all)&c(rep(FALSE,dim(dfread)[1]),rep(TRUE,dim(x)[1]))]
#write.table(all,"/home/mona/Desktop/Untitled Folderget/R/MyData3.csv",sep = ",",append = TRUE,row.names = FALSE , col.names = FALSE)
#write.table(s1,"/home/mona/Desktop/Untitled Folderget/R/MyData3.csv",sep = ",",append = TRUE,row.names = FALSE , col.names = FALSE)
#write.table(s2,"/home/mona/Desktop/Untitled Folderget/R/MyData3.csv",sep = ",",append = TRUE,row.names = FALSE , col.names = FALSE)
